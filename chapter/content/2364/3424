翌年初春，山寨粮草告罄，两次出兵攻打谁城，都被官军抵挡住了。没奈何，唐赛儿只得派出主力队伍，打算绕远路去灰州县劫粮。临行的前夜，一个名叫张小乙的司厨伙夫将丁谷叫到了僻静处。此人是他心腹，曾在战场上被他搭救过，虽然身无长技，却有些了身达命的见识。他悄悄与丁谷商量：“山上没有马匹骑兵，远路奔袭别处太冒险了；可要是不去，眼下又熬不过这场饥荒。”
丁谷问：“依你怎么看？”
小乙答道：“就如蜡烛两头点着，怕不能保全长久了。”
丁谷听罢，承谢了好意，但没跟他一同逃走，仍旧随众去了灰州。尽管十分谨慎，这消息却很快被细作传了出去，谁城长官立刻派遣骠骑营从后截杀，并且用飞鸽传书通知了别的州县。义军在半途中被包围了，几路装备精良的官军把他们的队伍切得零零散散，企图分而歼之。他们用刀枪、木棍、石锤、弓弩对抗着敌人的钢矛、火器、铠甲和马蹄。鏖战中，忽然淅沥沥地下了场雨，黑山脚下的丘陵变成了一片泥泞的屠场，鲜血被冲进沟渠里，只留下到处堆积的肮脏尸体和四处扬散的白森森的断肢，那里的土地从此肥沃了几百年。突出重围的一小队义军逃回了卸石棚寨，可这群残兵败卒无力再抵挡住官军的前后夹击，到了黄昏，山顶的崖洞被攻陷了。最后关头，唐赛儿身负重创，失去了手里的武器。眼看要让敌人擒住时，她厉声尖叫，喝令在旁边搏斗的丁谷刺死自己。丁谷头一回违拗了首领的意愿，上前帮她拼命抵挡，结果两人都力竭被缚了。